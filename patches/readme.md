
Apply the patch to the PHP source:

	cd src/php-8.3.8

    patch --dry-run -p1 < ../../patches/8.3.8-main.diff

    patch -p1 < ../../patches/8.3.8-main.diff
    patch -p1 < ../../patches/8.3.8-tests.diff

    php Zend/zend_vm_gen.php

To create a new patch:

	diff -ur ./php-8.3.8-orig/ ./php-8.3.8/ > ../patches/8.3.8-main.diff

	Edit the diff:

		- Remove "zend_vm_execute.h" (generated by zend_vm_gen.php)
		- Remove "zend_vm_handlers.h"
		- Remove "Stub hash" from "basic_functions_arginfo.h"
		- Use folders "a/" and "b/"
		- No timestamp.

Then compile...

```
brew install openssl bison re2c libiconv icu4c mhash libxml2 pkg-config;

export PKG_CONFIG="/opt/homebrew/bin/pkg-config" && \
export PKG_CONFIG_PATH="/opt/homebrew/opt/openssl@3/lib/pkgconfig:/opt/homebrew/opt/icu4c/lib/pkgconfig" && \
./buildconf && \
./configure \
    --enable-option-checking=fatal \
    --enable-opcache \
    --enable-fpm \
    --enable-cgi \
    --enable-bcmath \
    --enable-calendar \
    --enable-dba \
    --enable-exif \
    --enable-ftp \
    --enable-gd \
    --enable-mbregex \
    --enable-mbstring \
    --enable-mysqlnd \
    --enable-pcntl \
    --enable-phpdbg \
    --enable-phpdbg-readline \
    --enable-shmop \
    --enable-soap \
    --enable-sockets \
    --enable-sysvmsg \
    --enable-sysvsem \
    --enable-sysvshm \
    --enable-dtrace \
    --enable-intl \
    --with-curl \
    --with-external-gd \
    --with-external-pcre \
    --with-fpm-user=_www \
    --with-fpm-group=_www \
    --with-iconv=/opt/homebrew/opt/libiconv \
    --with-layout=GNU \
    --with-libxml \
    --with-libedit \
    --with-mhash=/opt/homebrew/opt/mhash \
    --with-mysql-sock=/tmp/mysql.sock \
    --with-mysqli=mysqlnd \
    --with-openssl \
    --with-password-argon2=/opt/homebrew/opt/argon2 \
    --with-pdo-dblib=/opt/homebrew/opt/freetds \
    --with-pdo-mysql=mysqlnd \
    --with-pdo-odbc=unixODBC,/opt/homebrew/opt/unixodbc \
    --with-pdo-pgsql=/opt/homebrew/opt/libpq \
    --with-pdo-sqlite=/usr \
    --with-pgsql=/opt/homebrew/opt/libpq \
    --with-pic \
    --with-pspell=/opt/homebrew/opt/aspell \
    --with-sodium \
    --with-sqlite3 \
    --with-unixODBC \
    --with-xsl \
    --with-zip \
    --with-zlib && \
make -j 6 && sed -i '' 's/9000/9001/g' ./sapi/fpm/www.conf && say "Done" || say "Error"; echo
```
